<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Generated by indoc on 23 Oct 2016 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="indoc_WI.css" rel="stylesheet" type="text/css" />
<title>19.15. Two rulebooks used internally</title>
<script type="text/javascript">
    function showExtra(id, imid) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
            document.getElementById(imid).src = 'inform:/doc_images/extra.png';
        } else {
            document.getElementById(id).style.display = 'block';
            document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
        }
    }
    function onLoaded() {
        if (window.location.hash) {
            var hash = window.location.hash.substring(2);
            if (hash.search("_") >= 0) {
                var res = hash.split("_");
                showExample("example"+res[1]);
            } else {
                showExample("example"+hash);
            }
        }
    }
    window.onload=onLoaded;
    function showExample(id) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
        } else {
            document.getElementById(id).style.display = 'block';
        }
    }
    function openExtra(id, imid) {
        document.getElementById(id).style.display = 'block';
        document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
    }
    function closeExtra(id, imid) {
        document.getElementById(id).style.display = 'none';
        document.getElementById(imid).src = 'inform:/doc_images/extra.png';
    }
</script>
</head>
<body class="paper papertint"><script language="JavaScript">
function pasteCode(code) {
    var myProject = window.Project;

    myProject.selectView('source');
    myProject.pasteCode(code);
}
</script>
<script language="JavaScript">
function createNewProject(code, title) {
    var myProject = window.Project;

    myProject.createNewProject(title, code);
}
</script>

<!-- SEARCH TITLE "Two rulebooks used internally" -->
<!-- SEARCH SECTION "19.15" -->
<!-- SEARCH SORT "000-019-015-000" -->
<!-- START IGNORE 340 -->
<div class="bookheader">
<table class="fullwidth midnightblack"><tr><td class="midnightbannerleftcell"><a href="doc340.html" class="standardlink"><img alt="Hookleft.png" src="inform:/doc_images/Hookleft.png" id="hookleft" /></a></td><td class="midnightbannercentrecell"><a href="index.html" class="standardlink"><span class="midnightbannertext">Chapter 19: Rulebooks</span></a></td><td class="midnightbannerrightcell"><a href="index.html" class="standardlink"><img alt="Hookup.png" src="inform:/doc_images/Hookup.png" id="hookup" /></a><a href="doc342.html" class="standardlink"><img alt="Hookright.png" src="inform:/doc_images/Hookright.png" id="hookright" /></a></td></tr></table></div>
<!-- END IGNORE -->
<p class="sectionheading">ยง19.15. Two rulebooks used internally</p>
<p>Rulebooks handle almost all of the important tasks which an Inform work of IF must carry out in order to keep play going. We have seen them used in clarifying the player's command, supplying missing ingredients, processing the action to see what should happen, responding, and so on: by this point in the documentation, it must look as if Inform uses rulebooks for everything.</p>
<p>This is nearly true. There is not actually a super-rulebook controlling everything. (Such a super-rulebook would need to repeat itself and never finish, something a rulebook is not allowed to do.) Instead, what happens during play looks like so:</p>
<!-- START CODE "c8034" -->
<a id="c8034"></a><blockquote class="code"><p class="quoted">
1. Following the &quot;when play begins&quot; rulebook.
<br />2. Repeating:
<br />&#160;&#160;&#160;&#160;2(a). Reading and parsing a command into an action;
<br />&#160;&#160;&#160;&#160;2(b). Following the &quot;action processing&quot; rulebook;
<br />&#160;&#160;&#160;&#160;2(c). Following the &quot;turn sequence&quot; rulebook.
<br />until the story has finished.
<br />3. Following the &quot;when play ends&quot; rulebook.
</p></blockquote>
<!-- END CODE -->
<p>The command parser occasionally calls on the services of activity rulebooks to help it, but otherwise gets on with its job in ways that we do not &quot;see&quot; as Inform 7 users. The rest of what happens involves rulebooks, and in particular two important beneath-the-surface rulebooks: action processing and turn sequence.</p>
<p>The <span class="boldface">action processing rules</span> are used whenever an action must be tried, by whoever tries it. This usually happens in response to player commands, but not always: it might happen because of a &quot;try...&quot;, and it can certainly interrupt an existing action.</p>
<p>The <span class="boldface">turn sequence rules</span> are used at the end of each turn, and include housekeeping as well as timekeeping. They consult the &quot;every turn&quot; rulebook, and advance the time of day, among other useful tasks.</p>
<p>In general, we should only modify the operation of these two crucial rulebooks as a last resort. Play can evidently fall to pieces if they cease to work normally.</p>
<hr />
<div class="bookexamples">
<p class="chapterheading"></p><!-- START EXAMPLE "408: Electrified" "e116" -->
<a id="e116"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example116'); return false;"><b>408</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example116'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Electrified</span></b></a><br />Adding a rule before the basic accessibility rule that will prevent the player from touching electrified objects under the wrong circumstances.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc86.html#e116"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example116" style="display: none;">
<p>Suppose we want to prevent the player from touching anything electrified -- not just as a response to TOUCH OBJECT, but at any time when the action would require contact with the object in question.</p>
<!-- START CODE "c8035_116" -->
<a id="c8035_116"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Electrified[=0x0022=][=0x000A=][=0x000A=]A thing can be safe or electrified. A thing is usually safe.[=0x000A=][=0x000A=]The Open Field is a room. [=0x0022=]At this end of the field is a wire fence separating farm country from the government testing grounds beyond.[=0x0022=] The wire fence is an electrified thing in Open Field. It is scenery. The description of the wire fence is [=0x0022=]Built into the fence is [a list of things which are part of the fence].[=0x0022=] The scary box is an electrified container. It is part of wire fence. In the scary box is an alluring prize.[=0x000A=][=0x000A=]The player carries a flashlight, a grappling hook, a very thick rubber glove, and a length of rope. The glove is wearable.[=0x000A=][=0x000A=]This is the electrocution-wisdom rule:[=0x000A=][=0x0009=]if the player wears the very thick rubber glove, make no decision;[=0x000A=][=0x0009=]if the action requires a touchable noun and the noun is electrified, say [=0x0022=]You fear touching [the noun].[=0x0022=] instead;[=0x000A=][=0x0009=]if the action requires a touchable second noun and the second noun is electrified, say [=0x0022=]You fear touching [the second noun].[=0x0022=] instead.[=0x000A=][=0x000A=]The electrocution-wisdom rule is listed before the basic accessibility rule in the action-processing rules.[=0x000A=][=0x000A=]Before touching the scary box:[=0x000A=][=0x0009=]say [=0x0022=]You can[=0x0027=]t help noticing a bright red sticker on the surface of the box.[=0x0022=] [This rule will fire even if we are not wearing the glove, because Before rules occur before basic accessibility.][=0x000A=][=0x000A=]Instead of opening the scary box:[=0x000A=][=0x0009=]say [=0x0022=]The scary box seems to be super-glued shut.[=0x0022=] [This one won[=0x0027=]t, because Instead rules occur after basic accessibility.][=0x000A=][=0x000A=]Test me with [=0x0022=]touch fence / touch box / open box / wear glove / open box[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" srcset="inform:/doc_images/paste.png 1x, inform:/doc_images/paste@2x.png 2x" width="13" height="13"/></a> <a href="javascript:createNewProject('[=0x0022=]Electrified[=0x0022=][=0x000A=][=0x000A=]A thing can be safe or electrified. A thing is usually safe.[=0x000A=][=0x000A=]The Open Field is a room. [=0x0022=]At this end of the field is a wire fence separating farm country from the government testing grounds beyond.[=0x0022=] The wire fence is an electrified thing in Open Field. It is scenery. The description of the wire fence is [=0x0022=]Built into the fence is [a list of things which are part of the fence].[=0x0022=] The scary box is an electrified container. It is part of wire fence. In the scary box is an alluring prize.[=0x000A=][=0x000A=]The player carries a flashlight, a grappling hook, a very thick rubber glove, and a length of rope. The glove is wearable.[=0x000A=][=0x000A=]This is the electrocution-wisdom rule:[=0x000A=][=0x0009=]if the player wears the very thick rubber glove, make no decision;[=0x000A=][=0x0009=]if the action requires a touchable noun and the noun is electrified, say [=0x0022=]You fear touching [the noun].[=0x0022=] instead;[=0x000A=][=0x0009=]if the action requires a touchable second noun and the second noun is electrified, say [=0x0022=]You fear touching [the second noun].[=0x0022=] instead.[=0x000A=][=0x000A=]The electrocution-wisdom rule is listed before the basic accessibility rule in the action-processing rules.[=0x000A=][=0x000A=]Before touching the scary box:[=0x000A=][=0x0009=]say [=0x0022=]You can[=0x0027=]t help noticing a bright red sticker on the surface of the box.[=0x0022=] [This rule will fire even if we are not wearing the glove, because Before rules occur before basic accessibility.][=0x000A=][=0x000A=]Instead of opening the scary box:[=0x000A=][=0x0009=]say [=0x0022=]The scary box seems to be super-glued shut.[=0x0022=] [This one won[=0x0027=]t, because Instead rules occur after basic accessibility.][=0x000A=][=0x000A=]Test me with [=0x0022=]touch fence / touch box / open box / wear glove / open box[=0x0022=].[=0x000A=]\n', 'Example - Electrified')"><img alt="create.png" src="inform:/doc_images/create.png" srcset="inform:/doc_images/create.png 1x, inform:/doc_images/create@2x.png 2x" width="26" height="13"/></a>&nbsp;&nbsp; &quot;Electrified&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8036_116" -->
<a id="c8036_116"></a><blockquote class="code"><p class="quoted">
A thing can be safe or electrified. A thing is usually safe.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8037_116" -->
<a id="c8037_116"></a><blockquote class="code"><p class="quoted">
The Open Field is a room. &quot;At this end of the field is a wire fence separating farm country from the government testing grounds beyond.&quot; The wire fence is an electrified thing in Open Field. It is scenery. The description of the wire fence is &quot;Built into the fence is [a list of things which are part of the fence].&quot; The scary box is an electrified container. It is part of wire fence. In the scary box is an alluring prize.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8038_116" -->
<a id="c8038_116"></a><blockquote class="code"><p class="quoted">
The player carries a flashlight, a grappling hook, a very thick rubber glove, and a length of rope. The glove is wearable.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8039_116" -->
<a id="c8039_116"></a><blockquote class="code"><p class="quoted">
This is the electrocution-wisdom rule:
<br />&#160;&#160;&#160;&#160;if the player wears the very thick rubber glove, make no decision;
<br />&#160;&#160;&#160;&#160;if the action requires a touchable noun and the noun is electrified, say &quot;You fear touching [the noun].&quot; instead;
<br />&#160;&#160;&#160;&#160;if the action requires a touchable second noun and the second noun is electrified, say &quot;You fear touching [the second noun].&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8040_116" -->
<a id="c8040_116"></a><blockquote class="code"><p class="quoted">
The electrocution-wisdom rule is listed before the basic accessibility rule in the action-processing rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8041_116" -->
<a id="c8041_116"></a><blockquote class="code"><p class="quoted">
Before touching the scary box:
<br />&#160;&#160;&#160;&#160;say &quot;You can't help noticing a bright red sticker on the surface of the box.&quot; [This rule will fire even if we are not wearing the glove, because Before rules occur before basic accessibility.]
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8042_116" -->
<a id="c8042_116"></a><blockquote class="code"><p class="quoted">
Instead of opening the scary box:
<br />&#160;&#160;&#160;&#160;say &quot;The scary box seems to be super-glued shut.&quot; [This one won't, because Instead rules occur after basic accessibility.]
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8043_116" -->
<a id="c8043_116"></a><blockquote class="code"><p class="quoted">
Test me with &quot;touch fence / touch box / open box / wear glove / open box&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "409: Timeless" "e387" -->
<a id="e387"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example387'); return false;"><b>409</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example387'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Timeless</span></b></a><br />A set of actions which do not take any game time at all.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc17.html#e387"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example387" style="display: none;">
<p>In a game with tight timing, it is sometimes friendliest to the player to let him LOOK and EXAMINE as much as necessary without being penalized.</p>
<!-- START CODE "c8044_387" -->
<a id="c8044_387"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Timeless[=0x0022=][=0x000A=][=0x000A=]Examining something is acting fast. Looking is acting fast.[=0x000A=][=0x000A=][Now we need a rule which, just at the right moment, stops the turn sequence rulebook in the cast of our new fast-acting actions:][=0x000A=][=0x000A=]The take visual actions out of world rule is listed before the every turn stage rule in the turn sequence rules.[=0x000A=][=0x000A=]This is the take visual actions out of world rule: if acting fast, rule succeeds.[=0x000A=][=0x000A=][Thus the rest of the turn sequence rulebook is omitted for looking or examining: in effect, they become out-of-world actions like [=0x0022=]saving the game[=0x0022=]. If we wanted to add, say, taking inventory to the list of instant activities, we would just need to define it as acting fast, too.][=0x000A=][=0x000A=][Now the scenario for testing:][=0x000A=][=0x000A=]When play begins:[=0x000A=][=0x0009=]say [=0x0022=]You are cornered by a pack of zombie wolves, armed only with a torch and a pair of pinking shears. This may be your last moment on earth, unless you can think fast![=0x0022=][=0x000A=][=0x000A=]Cleft is a room. [=0x0022=]You[=0x0027=]re backed into a cleft in the granite: behind you are only steep, high faces of stone, and before you a narrow passage.[=0x0022=][=0x000A=][=0x000A=]The plural of zombie wolf is zombie wolves. A zombie wolf is a kind of animal. Four zombie wolves are in Cleft.[=0x000A=][=0x000A=]Rule for writing a paragraph about zombie wolves:[=0x000A=][=0x0009=]say [=0x0022=]The good news is that there isn[=0x0027=]t much space in which for the zombie wolves to attack.[=0x0022=];[=0x000A=][=0x0009=]now every zombie wolf is mentioned.[=0x000A=][=0x000A=]A steep high face of stone is scenery in Cleft. Understand [=0x0022=]rock[=0x0022=] as the stone. The description is [=0x0022=]Now that you look more closely, there appear to be pitons driven into the rock.[=0x0022=][=0x000A=][=0x000A=]Some pitons are part of the stone. The description of the pitons is [=0x0022=]It looks as though someone else has made this ascent before.[=0x0022=][=0x000A=][=0x000A=]Instead of climbing the stone, try going up. Instead of climbing the pitons, try going up.[=0x000A=][=0x000A=]Above the Cleft is Clifftop.[=0x000A=][=0x000A=]Every turn when the location is Cleft:[=0x000A=][=0x0009=]say [=0x0022=]Alas, your time has run out. The alpha wolf springs--[=0x0022=];[=0x000A=][=0x0009=]end the story.[=0x000A=][=0x000A=]Every turn when the location is Clifftop:[=0x000A=][=0x0009=]say [=0x0022=]After a breathless climb, you emerge at last onto the open clifftop.[=0x0022=];[=0x000A=][=0x0009=]end the story finally.[=0x000A=][=0x000A=]Test me with [=0x0022=]x me / x stone / x pitons / climb pitons[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" srcset="inform:/doc_images/paste.png 1x, inform:/doc_images/paste@2x.png 2x" width="13" height="13"/></a> <a href="javascript:createNewProject('[=0x0022=]Timeless[=0x0022=][=0x000A=][=0x000A=]Examining something is acting fast. Looking is acting fast.[=0x000A=][=0x000A=][Now we need a rule which, just at the right moment, stops the turn sequence rulebook in the cast of our new fast-acting actions:][=0x000A=][=0x000A=]The take visual actions out of world rule is listed before the every turn stage rule in the turn sequence rules.[=0x000A=][=0x000A=]This is the take visual actions out of world rule: if acting fast, rule succeeds.[=0x000A=][=0x000A=][Thus the rest of the turn sequence rulebook is omitted for looking or examining: in effect, they become out-of-world actions like [=0x0022=]saving the game[=0x0022=]. If we wanted to add, say, taking inventory to the list of instant activities, we would just need to define it as acting fast, too.][=0x000A=][=0x000A=][Now the scenario for testing:][=0x000A=][=0x000A=]When play begins:[=0x000A=][=0x0009=]say [=0x0022=]You are cornered by a pack of zombie wolves, armed only with a torch and a pair of pinking shears. This may be your last moment on earth, unless you can think fast![=0x0022=][=0x000A=][=0x000A=]Cleft is a room. [=0x0022=]You[=0x0027=]re backed into a cleft in the granite: behind you are only steep, high faces of stone, and before you a narrow passage.[=0x0022=][=0x000A=][=0x000A=]The plural of zombie wolf is zombie wolves. A zombie wolf is a kind of animal. Four zombie wolves are in Cleft.[=0x000A=][=0x000A=]Rule for writing a paragraph about zombie wolves:[=0x000A=][=0x0009=]say [=0x0022=]The good news is that there isn[=0x0027=]t much space in which for the zombie wolves to attack.[=0x0022=];[=0x000A=][=0x0009=]now every zombie wolf is mentioned.[=0x000A=][=0x000A=]A steep high face of stone is scenery in Cleft. Understand [=0x0022=]rock[=0x0022=] as the stone. The description is [=0x0022=]Now that you look more closely, there appear to be pitons driven into the rock.[=0x0022=][=0x000A=][=0x000A=]Some pitons are part of the stone. The description of the pitons is [=0x0022=]It looks as though someone else has made this ascent before.[=0x0022=][=0x000A=][=0x000A=]Instead of climbing the stone, try going up. Instead of climbing the pitons, try going up.[=0x000A=][=0x000A=]Above the Cleft is Clifftop.[=0x000A=][=0x000A=]Every turn when the location is Cleft:[=0x000A=][=0x0009=]say [=0x0022=]Alas, your time has run out. The alpha wolf springs--[=0x0022=];[=0x000A=][=0x0009=]end the story.[=0x000A=][=0x000A=]Every turn when the location is Clifftop:[=0x000A=][=0x0009=]say [=0x0022=]After a breathless climb, you emerge at last onto the open clifftop.[=0x0022=];[=0x000A=][=0x0009=]end the story finally.[=0x000A=][=0x000A=]Test me with [=0x0022=]x me / x stone / x pitons / climb pitons[=0x0022=].[=0x000A=]\n', 'Example - Timeless')"><img alt="create.png" src="inform:/doc_images/create.png" srcset="inform:/doc_images/create.png 1x, inform:/doc_images/create@2x.png 2x" width="26" height="13"/></a>&nbsp;&nbsp; &quot;Timeless&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8045_387" -->
<a id="c8045_387"></a><blockquote class="code"><p class="quoted">
Examining something is acting fast. Looking is acting fast.
</p></blockquote>
<!-- END CODE -->
<p>Now we need a rule which, just at the right moment, stops the turn sequence rulebook in the cast of our new fast-acting actions:</p>
<!-- START CODE "c8046_387" -->
<a id="c8046_387"></a><blockquote class="code"><p class="quoted">
The take visual actions out of world rule is listed before the every turn stage rule in the turn sequence rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8047_387" -->
<a id="c8047_387"></a><blockquote class="code"><p class="quoted">
This is the take visual actions out of world rule: if acting fast, rule succeeds.
</p></blockquote>
<!-- END CODE -->
<p>Thus the rest of the turn sequence rulebook is omitted for looking or examining: in effect, they become out-of-world actions like &quot;saving the game&quot;. If we wanted to add, say, taking inventory to the list of instant activities, we would just need to define it as acting fast, too.</p>
<p>Now the scenario for testing:</p>
<!-- START CODE "c8048_387" -->
<a id="c8048_387"></a><blockquote class="code"><p class="quoted">
When play begins:
<br />&#160;&#160;&#160;&#160;say &quot;You are cornered by a pack of zombie wolves, armed only with a torch and a pair of pinking shears. This may be your last moment on earth, unless you can think fast!&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8049_387" -->
<a id="c8049_387"></a><blockquote class="code"><p class="quoted">
Cleft is a room. &quot;You're backed into a cleft in the granite: behind you are only steep, high faces of stone, and before you a narrow passage.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8050_387" -->
<a id="c8050_387"></a><blockquote class="code"><p class="quoted">
The plural of zombie wolf is zombie wolves. A zombie wolf is a kind of animal. Four zombie wolves are in Cleft.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8051_387" -->
<a id="c8051_387"></a><blockquote class="code"><p class="quoted">
Rule for writing a paragraph about zombie wolves:
<br />&#160;&#160;&#160;&#160;say &quot;The good news is that there isn't much space in which for the zombie wolves to attack.&quot;;
<br />&#160;&#160;&#160;&#160;now every zombie wolf is mentioned.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8052_387" -->
<a id="c8052_387"></a><blockquote class="code"><p class="quoted">
A steep high face of stone is scenery in Cleft. Understand &quot;rock&quot; as the stone. The description is &quot;Now that you look more closely, there appear to be pitons driven into the rock.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8053_387" -->
<a id="c8053_387"></a><blockquote class="code"><p class="quoted">
Some pitons are part of the stone. The description of the pitons is &quot;It looks as though someone else has made this ascent before.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8054_387" -->
<a id="c8054_387"></a><blockquote class="code"><p class="quoted">
Instead of climbing the stone, try going up. Instead of climbing the pitons, try going up.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8055_387" -->
<a id="c8055_387"></a><blockquote class="code"><p class="quoted">
Above the Cleft is Clifftop.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8056_387" -->
<a id="c8056_387"></a><blockquote class="code"><p class="quoted">
Every turn when the location is Cleft:
<br />&#160;&#160;&#160;&#160;say &quot;Alas, your time has run out. The alpha wolf springs--&quot;;
<br />&#160;&#160;&#160;&#160;end the story.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8057_387" -->
<a id="c8057_387"></a><blockquote class="code"><p class="quoted">
Every turn when the location is Clifftop:
<br />&#160;&#160;&#160;&#160;say &quot;After a breathless climb, you emerge at last onto the open clifftop.&quot;;
<br />&#160;&#160;&#160;&#160;end the story finally.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8058_387" -->
<a id="c8058_387"></a><blockquote class="code"><p class="quoted">
Test me with &quot;x me / x stone / x pitons / climb pitons&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "410: Endurance" "e122" -->
<a id="e122"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example122'); return false;"><b>410</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example122'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Endurance</span></b></a><br />Giving different actions a range of durations using a time allotment rulebook.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc17.html#e122"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example122" style="display: none;">
<p>Here we move to a systematic way of giving different durations to different actions, including even variations on the same act -- so that for instance climbing a steep hill might take several minutes more than other going actions. We do this by setting a number, &quot;work duration&quot;, to represent the number of minutes consumed by a given action, and then consulting a rulebook to find out how long the past turn's action should take. By default, an action will take 1 minute.</p>
<p>We'll start by emulating the behavior of &quot;Uptempo&quot;: each turn we'll set the clock forward most of the way, then check to see what has changed since the last turn, print any relevant events, and only then set the clock forward the final minute. The exception is when an action is set to take no time at all; in that case, we'll skip the rest of the turn sequence rules entirely.</p>
<!-- START CODE "c8059_122" -->
<a id="c8059_122"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode(' [=0x0022=]Endurance[=0x0022=][=0x000A=][=0x000A=]Work duration is a number that varies.[=0x000A=][=0x000A=]Every turn:[=0x000A=][=0x0009=]now work duration is 0;[=0x000A=][=0x0009=]increment the turn count;[=0x000A=][=0x0009=]follow the time allotment rules;[=0x000A=][=0x0009=]if work duration is 0, rule succeeds;[=0x000A=][=0x0009=]increase the time of day by (work duration minutes - 1 minute).[=0x000A=][=0x000A=]The time allotment rules are a rulebook.[=0x000A=][=0x000A=]A time allotment rule for examining or looking:[=0x000A=][=0x0009=]now work duration is 0;[=0x000A=][=0x0009=]rule succeeds.[=0x000A=][=0x000A=]A time allotment rule for going:[=0x000A=][=0x0009=]now work duration is 2;[=0x000A=][=0x0009=]rule succeeds.[=0x000A=][=0x000A=]A time allotment rule for going up:[=0x000A=][=0x0009=]now work duration is 5;[=0x000A=][=0x0009=]rule succeeds.[=0x000A=][=0x000A=]A time allotment rule for waiting:[=0x000A=][=0x0009=]now work duration is 10;[=0x000A=][=0x0009=]rule succeeds.[=0x000A=][=0x000A=]The last time allotment rule:[=0x000A=][=0x0009=]now work duration is 1.[=0x000A=][=0x000A=]When play begins: now the right hand status line is [=0x0022=][time of day][=0x0022=].[=0x000A=][=0x000A=]The Quai is a room. [=0x0022=]An attractive park at the edge of the river Aude: here you can wander among palm trees, and watch cyclists go by on the bike path; in the water there are ducks. In the cafe to your north, patrons sip their pastis; and above you is the medieval walled city and its castle.[=0x0022=][=0x000A=][=0x000A=]The Cafe is north of the Quai. [=0x0022=]A charming collection of umbrella-shaded tables, from which one can watch the river and the walls of the city beyond. The noise of traffic is only a minor distraction.[=0x0022=][=0x000A=][=0x000A=]The City is above the Quai.[=0x000A=][=0x000A=]After going to the City:[=0x000A=][=0x0009=]say [=0x0022=]You struggle uphill for some distance...[=0x0022=];[=0x000A=][=0x0009=]continue the action.[=0x000A=][=0x000A=]At 9:15 AM:[=0x000A=][=0x0009=]say [=0x0022=]The bells ring out from Place Carnot.[=0x0022=][=0x000A=][=0x000A=]Test me with [=0x0022=]z / n / s / u[=0x0022=].[=0x000A=][=0x000A=][=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" srcset="inform:/doc_images/paste.png 1x, inform:/doc_images/paste@2x.png 2x" width="13" height="13"/></a> <a href="javascript:createNewProject(' [=0x0022=]Endurance[=0x0022=][=0x000A=][=0x000A=]Work duration is a number that varies.[=0x000A=][=0x000A=]Every turn:[=0x000A=][=0x0009=]now work duration is 0;[=0x000A=][=0x0009=]increment the turn count;[=0x000A=][=0x0009=]follow the time allotment rules;[=0x000A=][=0x0009=]if work duration is 0, rule succeeds;[=0x000A=][=0x0009=]increase the time of day by (work duration minutes - 1 minute).[=0x000A=][=0x000A=]The time allotment rules are a rulebook.[=0x000A=][=0x000A=]A time allotment rule for examining or looking:[=0x000A=][=0x0009=]now work duration is 0;[=0x000A=][=0x0009=]rule succeeds.[=0x000A=][=0x000A=]A time allotment rule for going:[=0x000A=][=0x0009=]now work duration is 2;[=0x000A=][=0x0009=]rule succeeds.[=0x000A=][=0x000A=]A time allotment rule for going up:[=0x000A=][=0x0009=]now work duration is 5;[=0x000A=][=0x0009=]rule succeeds.[=0x000A=][=0x000A=]A time allotment rule for waiting:[=0x000A=][=0x0009=]now work duration is 10;[=0x000A=][=0x0009=]rule succeeds.[=0x000A=][=0x000A=]The last time allotment rule:[=0x000A=][=0x0009=]now work duration is 1.[=0x000A=][=0x000A=]When play begins: now the right hand status line is [=0x0022=][time of day][=0x0022=].[=0x000A=][=0x000A=]The Quai is a room. [=0x0022=]An attractive park at the edge of the river Aude: here you can wander among palm trees, and watch cyclists go by on the bike path; in the water there are ducks. In the cafe to your north, patrons sip their pastis; and above you is the medieval walled city and its castle.[=0x0022=][=0x000A=][=0x000A=]The Cafe is north of the Quai. [=0x0022=]A charming collection of umbrella-shaded tables, from which one can watch the river and the walls of the city beyond. The noise of traffic is only a minor distraction.[=0x0022=][=0x000A=][=0x000A=]The City is above the Quai.[=0x000A=][=0x000A=]After going to the City:[=0x000A=][=0x0009=]say [=0x0022=]You struggle uphill for some distance...[=0x0022=];[=0x000A=][=0x0009=]continue the action.[=0x000A=][=0x000A=]At 9:15 AM:[=0x000A=][=0x0009=]say [=0x0022=]The bells ring out from Place Carnot.[=0x0022=][=0x000A=][=0x000A=]Test me with [=0x0022=]z / n / s / u[=0x0022=].[=0x000A=][=0x000A=][=0x000A=]\n', 'Example - Endurance')"><img alt="create.png" src="inform:/doc_images/create.png" srcset="inform:/doc_images/create.png 1x, inform:/doc_images/create@2x.png 2x" width="26" height="13"/></a>&nbsp;&nbsp;  &quot;Endurance&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8060_122" -->
<a id="c8060_122"></a><blockquote class="code"><p class="quoted">
Work duration is a number that varies.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8061_122" -->
<a id="c8061_122"></a><blockquote class="code"><p class="quoted">
Every turn:
<br />&#160;&#160;&#160;&#160;now work duration is 0;
<br />&#160;&#160;&#160;&#160;increment the turn count;
<br />&#160;&#160;&#160;&#160;follow the time allotment rules;
<br />&#160;&#160;&#160;&#160;if work duration is 0, rule succeeds;
<br />&#160;&#160;&#160;&#160;increase the time of day by (work duration minutes - 1 minute).
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8062_122" -->
<a id="c8062_122"></a><blockquote class="code"><p class="quoted">
The time allotment rules are a rulebook.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8063_122" -->
<a id="c8063_122"></a><blockquote class="code"><p class="quoted">
A time allotment rule for examining or looking:
<br />&#160;&#160;&#160;&#160;now work duration is 0;
<br />&#160;&#160;&#160;&#160;rule succeeds.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8064_122" -->
<a id="c8064_122"></a><blockquote class="code"><p class="quoted">
A time allotment rule for going:
<br />&#160;&#160;&#160;&#160;now work duration is 2;
<br />&#160;&#160;&#160;&#160;rule succeeds.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8065_122" -->
<a id="c8065_122"></a><blockquote class="code"><p class="quoted">
A time allotment rule for going up:
<br />&#160;&#160;&#160;&#160;now work duration is 5;
<br />&#160;&#160;&#160;&#160;rule succeeds.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8066_122" -->
<a id="c8066_122"></a><blockquote class="code"><p class="quoted">
A time allotment rule for waiting:
<br />&#160;&#160;&#160;&#160;now work duration is 10;
<br />&#160;&#160;&#160;&#160;rule succeeds.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8067_122" -->
<a id="c8067_122"></a><blockquote class="code"><p class="quoted">
The last time allotment rule:
<br />&#160;&#160;&#160;&#160;now work duration is 1.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8068_122" -->
<a id="c8068_122"></a><blockquote class="code"><p class="quoted">
When play begins: now the right hand status line is &quot;[time of day]&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8069_122" -->
<a id="c8069_122"></a><blockquote class="code"><p class="quoted">
The Quai is a room. &quot;An attractive park at the edge of the river Aude: here you can wander among palm trees, and watch cyclists go by on the bike path; in the water there are ducks. In the cafe to your north, patrons sip their pastis; and above you is the medieval walled city and its castle.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8070_122" -->
<a id="c8070_122"></a><blockquote class="code"><p class="quoted">
The Cafe is north of the Quai. &quot;A charming collection of umbrella-shaded tables, from which one can watch the river and the walls of the city beyond. The noise of traffic is only a minor distraction.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8071_122" -->
<a id="c8071_122"></a><blockquote class="code"><p class="quoted">
The City is above the Quai.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8072_122" -->
<a id="c8072_122"></a><blockquote class="code"><p class="quoted">
After going to the City:
<br />&#160;&#160;&#160;&#160;say &quot;You struggle uphill for some distance...&quot;;
<br />&#160;&#160;&#160;&#160;continue the action.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8073_122" -->
<a id="c8073_122"></a><blockquote class="code"><p class="quoted">
At 9:15 AM:
<br />&#160;&#160;&#160;&#160;say &quot;The bells ring out from Place Carnot.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8074_122" -->
<a id="c8074_122"></a><blockquote class="code"><p class="quoted">
Test me with &quot;z / n / s / u&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "411: Escape from the Seraglio" "e127" -->
<a id="e127"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example127'); return false;"><b>411</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example127'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Escape from the Seraglio</span></b></a><br />Replacing the usual response to TAKE ALL so that instead of output such as "grapes: Taken. orange: Taken.", Inform produces variable responses in place of "grapes:".</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc43.html#e127"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example127" style="display: none;">
<!-- START CODE "c8075_127" -->
<a id="c8075_127"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Escape from the Seraglio[=0x0022=][=0x000A=][=0x000A=]Section 1 - Special Announcement Rules[=0x000A=][=0x000A=]The number of takes this turn is a number that varies. Every turn: now the number of takes this turn is 0.[=0x000A=][=0x000A=]The friskily announce items from multiple object lists rule is listed instead of the announce items from multiple object lists rule in the action-processing rules.[=0x000A=][=0x000A=]This is the friskily announce items from multiple object lists rule:[=0x000A=][=0x0009=]if taking:[=0x000A=][=0x0009=][=0x0009=]if the current item from the multiple object list is not nothing:[=0x000A=][=0x0009=][=0x0009=][=0x0009=]increment the number of takes this turn;[=0x000A=][=0x0009=][=0x0009=][=0x0009=]say [=0x0022=][if number of takes this turn is 1]First [otherwise if the number of takes this turn is 2]And then [otherwise if the number of takes this turn is 3]And I suppose also [otherwise if the number of takes this turn is 7]And on we wearily go with [otherwise if the number of takes this turn is 9]Oh, and not forgetting [otherwise]And [end if][the current item from the multiple object list]: [run paragraph on][=0x0022=];[=0x000A=][=0x0009=]otherwise:[=0x000A=][=0x0009=][=0x0009=]if the current item from the multiple object list is not nothing, say [=0x0022=][current item from the multiple object list]: [run paragraph on][=0x0022=].[=0x000A=][=0x000A=]Rule for deciding whether all includes the person asked: it does not.[=0x000A=]Rule for deciding whether all includes a person when taking: it does not.[=0x000A=][=0x000A=]Section 2 - The Scenario[=0x000A=][=0x000A=]The Palm Chamber is a room. Sarissa is a woman in the Palm Chamber.[=0x000A=][=0x000A=]The Palm Chamber contains a bottle of ink, a quill pen, a tangerine, a bunch of grapes, a length of silken rope, some perfume, a cake of incense, a fitted leather bodice, a sapphire anklet, an illustrated novel, a whip, and a heavy iron key.[=0x000A=][=0x000A=]A persuasion rule for asking Sarissa to try taking the key:[=0x000A=][=0x0009=]say [=0x0022=]Sarissa nervously demurs, knowing that it is forbidden.[=0x0022=];[=0x000A=][=0x0009=]persuasion fails.[=0x000A=][=0x000A=]A persuasion rule: persuasion succeeds.[=0x000A=][=0x000A=]Test me with [=0x0022=]take all / drop all / sarissa, take all[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" srcset="inform:/doc_images/paste.png 1x, inform:/doc_images/paste@2x.png 2x" width="13" height="13"/></a> <a href="javascript:createNewProject('[=0x0022=]Escape from the Seraglio[=0x0022=][=0x000A=][=0x000A=]Section 1 - Special Announcement Rules[=0x000A=][=0x000A=]The number of takes this turn is a number that varies. Every turn: now the number of takes this turn is 0.[=0x000A=][=0x000A=]The friskily announce items from multiple object lists rule is listed instead of the announce items from multiple object lists rule in the action-processing rules.[=0x000A=][=0x000A=]This is the friskily announce items from multiple object lists rule:[=0x000A=][=0x0009=]if taking:[=0x000A=][=0x0009=][=0x0009=]if the current item from the multiple object list is not nothing:[=0x000A=][=0x0009=][=0x0009=][=0x0009=]increment the number of takes this turn;[=0x000A=][=0x0009=][=0x0009=][=0x0009=]say [=0x0022=][if number of takes this turn is 1]First [otherwise if the number of takes this turn is 2]And then [otherwise if the number of takes this turn is 3]And I suppose also [otherwise if the number of takes this turn is 7]And on we wearily go with [otherwise if the number of takes this turn is 9]Oh, and not forgetting [otherwise]And [end if][the current item from the multiple object list]: [run paragraph on][=0x0022=];[=0x000A=][=0x0009=]otherwise:[=0x000A=][=0x0009=][=0x0009=]if the current item from the multiple object list is not nothing, say [=0x0022=][current item from the multiple object list]: [run paragraph on][=0x0022=].[=0x000A=][=0x000A=]Rule for deciding whether all includes the person asked: it does not.[=0x000A=]Rule for deciding whether all includes a person when taking: it does not.[=0x000A=][=0x000A=]Section 2 - The Scenario[=0x000A=][=0x000A=]The Palm Chamber is a room. Sarissa is a woman in the Palm Chamber.[=0x000A=][=0x000A=]The Palm Chamber contains a bottle of ink, a quill pen, a tangerine, a bunch of grapes, a length of silken rope, some perfume, a cake of incense, a fitted leather bodice, a sapphire anklet, an illustrated novel, a whip, and a heavy iron key.[=0x000A=][=0x000A=]A persuasion rule for asking Sarissa to try taking the key:[=0x000A=][=0x0009=]say [=0x0022=]Sarissa nervously demurs, knowing that it is forbidden.[=0x0022=];[=0x000A=][=0x0009=]persuasion fails.[=0x000A=][=0x000A=]A persuasion rule: persuasion succeeds.[=0x000A=][=0x000A=]Test me with [=0x0022=]take all / drop all / sarissa, take all[=0x0022=].[=0x000A=]\n', 'Example - Escape from the Seraglio')"><img alt="create.png" src="inform:/doc_images/create.png" srcset="inform:/doc_images/create.png 1x, inform:/doc_images/create@2x.png 2x" width="26" height="13"/></a>&nbsp;&nbsp; &quot;Escape from the Seraglio&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8076_127" -->
<a id="c8076_127"></a><blockquote class="code"><p class="quoted">
Section 1 - Special Announcement Rules
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8077_127" -->
<a id="c8077_127"></a><blockquote class="code"><p class="quoted">
The number of takes this turn is a number that varies. Every turn: now the number of takes this turn is 0.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8078_127" -->
<a id="c8078_127"></a><blockquote class="code"><p class="quoted">
The friskily announce items from multiple object lists rule is listed instead of the announce items from multiple object lists rule in the action-processing rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8079_127" -->
<a id="c8079_127"></a><blockquote class="code"><p class="quoted">
This is the friskily announce items from multiple object lists rule:
<br />&#160;&#160;&#160;&#160;if taking:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the current item from the multiple object list is not nothing:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;increment the number of takes this turn;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[if number of takes this turn is 1]First [otherwise if the number of takes this turn is 2]And then [otherwise if the number of takes this turn is 3]And I suppose also [otherwise if the number of takes this turn is 7]And on we wearily go with [otherwise if the number of takes this turn is 9]Oh, and not forgetting [otherwise]And [end if][the current item from the multiple object list]: [run paragraph on]&quot;;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the current item from the multiple object list is not nothing, say &quot;[current item from the multiple object list]: [run paragraph on]&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8080_127" -->
<a id="c8080_127"></a><blockquote class="code"><p class="quoted">
Rule for deciding whether all includes the person asked: it does not.
<br />Rule for deciding whether all includes a person when taking: it does not.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8081_127" -->
<a id="c8081_127"></a><blockquote class="code"><p class="quoted">
Section 2 - The Scenario
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8082_127" -->
<a id="c8082_127"></a><blockquote class="code"><p class="quoted">
The Palm Chamber is a room. Sarissa is a woman in the Palm Chamber.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8083_127" -->
<a id="c8083_127"></a><blockquote class="code"><p class="quoted">
The Palm Chamber contains a bottle of ink, a quill pen, a tangerine, a bunch of grapes, a length of silken rope, some perfume, a cake of incense, a fitted leather bodice, a sapphire anklet, an illustrated novel, a whip, and a heavy iron key.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8084_127" -->
<a id="c8084_127"></a><blockquote class="code"><p class="quoted">
A persuasion rule for asking Sarissa to try taking the key:
<br />&#160;&#160;&#160;&#160;say &quot;Sarissa nervously demurs, knowing that it is forbidden.&quot;;
<br />&#160;&#160;&#160;&#160;persuasion fails.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8085_127" -->
<a id="c8085_127"></a><blockquote class="code"><p class="quoted">
A persuasion rule: persuasion succeeds.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8086_127" -->
<a id="c8086_127"></a><blockquote class="code"><p class="quoted">
Test me with &quot;take all / drop all / sarissa, take all&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
</div>
<!-- START IGNORE -->
<div class="bookfooter">
<table class="fullwidth"><tr><td class="footerprevious"><a href="doc340.html" class="footerlink">Previous</a></td><td class="footercontents"><a href="index.html" class="footerlink">Contents</a></td><td class="footernext"><a href="doc342.html" class="footerlink">Next</a></td></tr></table>
</div>
<!-- END IGNORE -->
</body>
</html>
