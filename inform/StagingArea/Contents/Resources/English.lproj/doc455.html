<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Generated by indoc on 23 Oct 2016 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="indoc_WI.css" rel="stylesheet" type="text/css" />
<title>27.26. The template layer</title>
<script type="text/javascript">
    function showExtra(id, imid) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
            document.getElementById(imid).src = 'inform:/doc_images/extra.png';
        } else {
            document.getElementById(id).style.display = 'block';
            document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
        }
    }
    function onLoaded() {
        if (window.location.hash) {
            var hash = window.location.hash.substring(2);
            if (hash.search("_") >= 0) {
                var res = hash.split("_");
                showExample("example"+res[1]);
            } else {
                showExample("example"+hash);
            }
        }
    }
    window.onload=onLoaded;
    function showExample(id) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
        } else {
            document.getElementById(id).style.display = 'block';
        }
    }
    function openExtra(id, imid) {
        document.getElementById(id).style.display = 'block';
        document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
    }
    function closeExtra(id, imid) {
        document.getElementById(id).style.display = 'none';
        document.getElementById(imid).src = 'inform:/doc_images/extra.png';
    }
</script>
</head>
<body class="paper papertint"><script language="JavaScript">
function pasteCode(code) {
    var myProject = window.Project;

    myProject.selectView('source');
    myProject.pasteCode(code);
}
</script>
<script language="JavaScript">
function createNewProject(code, title) {
    var myProject = window.Project;

    myProject.createNewProject(title, code);
}
</script>

<!-- SEARCH TITLE "The template layer" -->
<!-- SEARCH SECTION "27.26" -->
<!-- SEARCH SORT "000-027-026-000" -->
<!-- START IGNORE 454 -->
<div class="bookheader">
<table class="fullwidth midnightblack"><tr><td class="midnightbannerleftcell"><a href="doc454.html" class="standardlink"><img alt="Hookleft.png" src="inform:/doc_images/Hookleft.png" id="hookleft" /></a></td><td class="midnightbannercentrecell"><a href="index.html" class="standardlink"><span class="midnightbannertext">Chapter 27: Extensions</span></a></td><td class="midnightbannerrightcell"><a href="index.html" class="standardlink"><img alt="Hookup.png" src="inform:/doc_images/Hookup.png" id="hookup" /></a><a href="doc456.html" class="standardlink"><img alt="Hookright.png" src="inform:/doc_images/Hookright.png" id="hookright" /></a></td></tr></table></div>
<!-- END IGNORE -->
<p class="sectionheading">ยง27.26. The template layer</p>
<p>When Go is clicked, Inform translates the I7 source text into I6 code, but the directly translated code could not survive on its own: it needs a large body of supporting code, also written in I6, to sustain it. (Just as a program like iTunes or Firefox cannot run on a bare machine, but needs an operating system already up and running to support it.) Until 2008, this supporting code was provided by the I6 library, that is, the standard distribution of useful I6 code supplied with distributions of Inform 6.</p>
<p>However, the supporting code is now generated from a collection of about 35 &quot;segments&quot; of I6 code which together make up &quot;the template layer&quot;. The reason for the term &quot;template&quot; is that the segments are not quite directly copied into I7's output, but instead act as templates from which I7 generates code - the final output contains variations according to what the original source text needs.</p>
<p>Each segment has its own name, which looks like a leafname plus the &quot;.i6t&quot; filename extension (which stands for &quot;I6 template&quot;). Internally, a segment is itself divided up into named parts. For instance, the segment &quot;Relations.i6t&quot; contains a part called &quot;Symmetric One To One Relations&quot; which provides I6 routines for changing and testing such relations. There are more than 600 named parts across the template as a whole; it is quite a large program. An annotated, typeset version of the template - amounting to a roughly 500-page book - is available for download from the Inform website.</p>
<p>The most powerful use of &quot;Include&quot; allows code to included before, instead of or after any named part or segment in the template. For example:</p>
<!-- START CODE "c9247" -->
<a id="c9247"></a><blockquote class="code"><p class="quoted">
Include (- ... -) before &quot;Relations.i6t&quot;.
<br />Include (- ... -) instead of &quot;Relations.i6t&quot;.
<br />Include (- ... -) after &quot;Symmetric One To One Relations&quot; in &quot;Relations.i6t&quot;.
</p></blockquote>
<!-- END CODE -->
<p>Multiple such inclusions can be made for the same segment or part. If so, all will take effect in the case of &quot;before&quot; or &quot;after&quot;, but for &quot;instead of&quot; only the most recent one takes effect. Inclusions requested before, or after, a segment or part which has been replaced with &quot;instead of&quot; will take effect and appear before or after the code which appears instead of it.</p>
<p>The pre-2008 syntax</p>
<!-- START CODE "c9248" -->
<a id="c9248"></a><blockquote class="code"><p class="quoted">
Include (- ... -) before the library.
</p></blockquote>
<!-- END CODE -->
<p>has been withdrawn; the new syntax</p>
<!-- START CODE "c9249" -->
<a id="c9249"></a><blockquote class="code"><p class="quoted">
Include (- ... -) after &quot;Definitions.i6t&quot;.
</p></blockquote>
<!-- END CODE -->
<p>should have the same effect.</p>
<p>Template files are not written in literal I6, but in a marked-up, annotated form of I6 which has special transcription commands embedded into it. These commands should absolutely not be used except in the built-in template files, with one exception:</p>
<!-- START CODE "c9250" -->
<a id="c9250"></a><blockquote class="code"><p class="quoted">
{-segment:Flowers.i6t}
</p></blockquote>
<!-- END CODE -->
<p>places the whole of the template file &quot;Flowers.i6t&quot; in this position. The built-in template does not of course contain &quot;Flowers.i6t&quot;, but Inform allows the optional &quot;I6T&quot; subfolder of the &quot;.materials&quot; folder of a project to hold additional or replacement template files. Thus the project &quot;Botanic Gardens.inform&quot; might store:</p>
<!-- START CODE "c9251" -->
<a id="c9251"></a><blockquote class="code"><p class="quoted">
Botanic Gardens.materials/I6T/Flowers.i6t
</p></blockquote>
<!-- END CODE -->
<p>It could even contain:</p>
<!-- START CODE "c9252" -->
<a id="c9252"></a><blockquote class="code"><p class="quoted">
Botanic Gardens.materials/I6T/Relations.i6t
</p></blockquote>
<!-- END CODE -->
<p>in which case this would automatically be used instead of the built-in copy of &quot;Relations.i6t&quot;, without any change to the I7 source text being needed. In this way, projects can (if they need to) use partly or entirely customised templates.</p>
<p>One application of this might allow for chunks of I6 code generated by external utilities - Perl scripts, lex and yacc, or other code generators - by compiling those to suitable template files in .materials/I6T and then using an inclusion like</p>
<!-- START CODE "c9253" -->
<a id="c9253"></a><blockquote class="code"><p class="quoted">
Include (- {-segment:MyStuff.i6t} -).
</p></blockquote>
<!-- END CODE -->
<p>in the I7 source text.</p>
<p>Template hacking, as it's called, is a last resort. If there is any way to achieve the same ends by writing ordinary I7 source text, then that will always be better. If it is possible to write &quot;Include (- ... -)&quot; without mentioning any segment or part, that's much to be preferred, because it has more chance of continuing to work into the future when the template might have been rewritten.</p>
<hr />
<!-- START IGNORE -->
<div class="bookfooter">
<table class="fullwidth"><tr><td class="footerprevious"><a href="doc454.html" class="footerlink">Previous</a></td><td class="footercontents"><a href="index.html" class="footerlink">Contents</a></td><td class="footernext"><a href="doc456.html" class="footerlink">Next</a></td></tr></table>
</div>
<!-- END IGNORE -->
</body>
</html>
